// room script file
bool firstEntry = true;
bool diedOnce = false;

function room_LeaveBottom()
{
  player.ChangeRoom(2);
}

function room_AfterFadeIn()
{
  if (firstEntry){
    cMick.Walk(255, 700, eBlock);
    cSal.SayAt(450, 60, 500, "Dude!! You're in me! Ha ha that's awesome!");
    cMick.Say("Oh so is that the deal? A little fuel and you're all nice now?");
    cSal.SayAt(450, 60, 500, "Yeah bro sorry about being an ass earlier, I'm all good now.");
    cSal.SayAt(450, 60, 500, "You can just go on through the door, it'll lead you out.");
    cMick.Say("Sweet. Thanks, I guess.");
    firstEntry = false;
  }
  else {
    cMick.Walk(255,  700,  eBlock);
    cSal.SayAt(450, 60, 500, "TWICE?? Ha ha you fell for it twice!");
    cSal.SayAt(450, 60, 500, "You know what they say... fool me twice..");
    cMick.Say("JUST SHUT UP ALREADY WILL YA??");
    cMick.Say("Can you please just tell me how to get out of this place?");
    cSal.SayAt(450, 60, 500, "Oh sure bro, why didn't you ask? I can take you out of here for sure!");
    cMick.Say("Somehow I don't believe you..");
    cSal.SayAt(450, 60, 500, "Just come over and activate the computer.");
    cSal.SayAt(450, 60, 500, "That's password protected. By me.");
    cMick.Say("*sigh*");
  }
}
function room_Load()
{
  cMick.x = 255;
  cMick.y = 765;
  cMick.Baseline = 120;
  cSal.x = 455;
  cSal.y = 50;
  if (oFlood.Visible){
    oFlood.Visible = false;
  }
  cSal.ChangeRoom(3);
  oOpenDoor.Visible = false;
  oClosedDoor.Visible = true;
}

function oClosedDoor_Interact()
{
  cMick.Walk(66, 476, eBlock);
  if (!diedOnce){
    bgAudio.Stop();
    oOpenDoor.Visible = true;
    oClosedDoor.Visible = false;
    oFlood.Visible = true;
    oFlood.SetView(9, 0, 0);
    oFlood.Animate(0, 7, eOnce, eNoBlock, eForwards);
    cSal.SayAt(450, 60, 500, "This is too good ha ha! I can't breath!! And neither can you!");
    aDeath_sound.Play(eAudioPriorityHigh);
    
    diedOnce = true;
    justDied = true;
    player.ChangeRoom(1);
  }
  else if (passwordEntered){
    oOpenDoor.Visible = true;
    oClosedDoor.Visible = false;
    cSal.SayAt(450, 60, 500, "Well, that's it. You sure you don't wanna hang?");
    cMick.Say("Yeah. Pretty sure.");
    player.ChangeRoom(4);
  }
  else {
    cSal.SayAt(450, 60, 500, "Don't bother, I locked it.");
  }
}

function hCabinet_Interact()
{
  if (diedOnce){
    cMick.Walk(848,  584,  eBlock);
    gDrawer.Visible = true;
    gDrawer.SetPosition(168, 50);
  }
  else {
    cSal.SayAt(450, 60, 500, "I said the door is right there.");
  }
}



function hWallText_UseInv()
{
  if (player.ActiveInventory == iMagGlass) {
    cMick.Walk(556, 340,  eBlock);
    gWallText.Visible = true;
    gWallText.SetPosition(168, 50);
  }
}


function hWallText_Interact()
{
  cMick.Walk(556, 340, eBlock);
  cMick.Say("It seems like something is written here.. Too small to make out though.");
}

function hWallText_Look()
{
  cMick.Walk(556, 340, eBlock);
  cMick.Say("It seems like something is written here.. Too small to make out though.");
}

function hComp_Interact()
{
  if (diedOnce){
    cMick.Walk(728, 380, eBlock);
    gCompScreen.Visible = true;
    gCompScreen.SetPosition(168, 50);
  }
  else {
    cSal.SayAt(450, 60, 500, "I said the door is right there.");
  }
}

function hScope_Interact()
{
  cSal.SayAt(450, 60, 500, "Ahh! What are you doing!? Get out of here!");
  cMick.Say("I'll.. just pretend I didn't see that..");
}

function hScope_Look()
{
  cSal.SayAt(450, 60, 500, "Dude, not cool. Those are my private parts.");
}

function hMap_Interact()
{
  if (diedOnce){
    cMick.Walk(363, 374, eBlock);
    cMick.Say("Maybe if I find certain coordinates on the map...");
    cSal.SayAt(450, 60, 500, "Oh good idea! I should've thought of that myself!");
  }
  else {
    cSal.SayAt(450, 60, 500, "I said the door is right there.");
  }
}

function hMap_Look()
{
  cMick.Say("I wonder where that is...");
}

function hDashboard_Look()
{
  cMick.Say("That's a funky looking dashboard..");
}

function hDashboard_Interact()
{
  if (diedOnce){
    cMick.Walk(218, 491, eBlock);
    cSal.SayAt(450, 60, 500, "Give up Derek! You'll never find the PASSWORD in there!!");
    cMick.Say("Dammit S.A.L....");
  }
  else {
    cSal.SayAt(450, 60, 500, "I said the door is right there.");
  }
}
